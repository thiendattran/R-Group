Rmd_R in Data Science
================
Nguyen Truong
2023-04-01

# Introduction

1.  Format: unified framework

- codes
- its results
- prose commentary

2.  features

- .Rmd files: Develop your code and ideas side-by-side in a single
  document. Run code as individual chunks or as an entire document
- Dynamic Documents · Knit together plots, tables, and results with
  narrative text. Render to a variety of formats like HTML, PDF, MS
  Word, or MS Powerpoint.
- Reproducible Research · Upload, link to, or attach your report to
  share. Anyone can read or run your code to reproduce your work.

3.  Advantages:

- reproducible  
- support dozens of output formats, like html, PDFs, Word files,
  slideshows, and more.

4.  Guidance for R Markdown

- R Markdown cheat sheet:
  <https://drive.google.com/drive/u/0/folders/1AiImxk_SL6lJ1jTfOPU93BOunIwGk8TF>
- R Mardow reference:
  <https://drive.google.com/drive/u/0/folders/1AiImxk_SL6lJ1jTfOPU93BOunIwGk8TF>
- <https://rstudio.com/resources/cheatsheets/>.

# R Markdown basic

## 1. This is an R Markdown file, a plain text file that has the extension .Rmd:

title: “Diamond sizes” date: 2016-08-25 output: html_document —

We have data about 53940 diamonds. Only 126 are larger than 2.5 carats.
The distribution of the remainder is shown below:

![](Chapter-27-R-Markdown_files/figure-gfm/plot%20-1.png)<!-- -->

- It contains three important types of content:
  - An (optional) YAML header surrounded by —s.
  - Chunks of R code surrounded by \`\`\`.

2.  To produce and share a complete report

- click “Knit” or press Cmd/Ctrl + Shift + K. The report will display
  the report in the viewer pane, and create a self-contained HTML file
  that you can share with others.
- When you knit the document, R Markdown sends the .Rmd file to knitr,
  <http://yihui.name/knitr/>, which executes all of the code chunks and
  creates a new markdown (.md) document which includes the code and its
  output. The markdown file generated by knitr is then processed by
  pandoc, <http://pandoc.org/>, which is responsible for creating the
  finished file. The advantage of this two step workflow is that you can
  create a very wide range of output formats, as you’ll learn about in R
  markdown formats.
  ![](path/to/Screen%20Shot%202023-04-01%20at%2010.08.12.png)

# Text formatting with Markdown

<https://drive.google.com/drive/u/0/folders/1AiImxk_SL6lJ1jTfOPU93BOunIwGk8TF>

# Code chunk

- to insert a chunk
  - The keyboard shortcut Cmd/Ctrl + Alt + I
  - The “Insert” button icon in the editor toolbar
  - By manually typing the chunk delimiters `{r} and`
- run code in a chunk
  - Cmd/Ctrl + Shift + Enter or button green on the right side: run all
    codes in a chunk
  - Cmd/Ctrl + Enter: continue to run the code
- `{r chunk name, followed by comma separated options}. The chunk end is indicated by a final`.

\*chunk options: + include = FALSE runs the code, but doesn’t show the
code or results in the final document. Use this for setup code that you
don’t want cluttering your report. + echo = FALSE prevents code, but not
the results from appearing in the finished file. Use this when writing
reports aimed at people who don’t want to see the underlying R code. +
message = FALSE or warning = FALSE prevents messages or warnings from
appearing in the finished file. + results = ‘hide’ hides printed output;
fig.show = ‘hide’ hides plots. + error = TRUE causes the render to
continue even if code returns an error.

1.  Table

``` r
mtcars[1:5, ]
```

    ##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
    ## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
    ## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
    ## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
    ## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
    ## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2

``` r
knitr::kable(
  mtcars[1:5, ], 
  caption = "A knitr kable."
)
```

|                   |  mpg | cyl | disp |  hp | drat |    wt |  qsec |  vs |  am | gear | carb |
|:------------------|-----:|----:|-----:|----:|-----:|------:|------:|----:|----:|-----:|-----:|
| Mazda RX4         | 21.0 |   6 |  160 | 110 | 3.90 | 2.620 | 16.46 |   0 |   1 |    4 |    4 |
| Mazda RX4 Wag     | 21.0 |   6 |  160 | 110 | 3.90 | 2.875 | 17.02 |   0 |   1 |    4 |    4 |
| Datsun 710        | 22.8 |   4 |  108 |  93 | 3.85 | 2.320 | 18.61 |   1 |   1 |    4 |    1 |
| Hornet 4 Drive    | 21.4 |   6 |  258 | 110 | 3.08 | 3.215 | 19.44 |   1 |   0 |    3 |    1 |
| Hornet Sportabout | 18.7 |   8 |  360 | 175 | 3.15 | 3.440 | 17.02 |   0 |   0 |    3 |    2 |

A knitr kable.

2.  Caching

- cache = TRUE. When set, this will save the output of the chunk to a
  specially named file on disk. On subsequent runs, knitr will check to
  see if the code has changed, and if it hasn’t, it will reuse the
  cached results.

``` r
rawdata <- mtcars
rawdata
```

    ##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
    ## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
    ## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
    ## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
    ## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
    ## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
    ## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
    ## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
    ## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
    ## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
    ## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
    ## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
    ## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
    ## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
    ## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
    ## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
    ## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
    ## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
    ## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
    ## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
    ## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
    ## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
    ## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
    ## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
    ## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
    ## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
    ## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
    ## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
    ## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
    ## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
    ## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
    ## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
    ## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2

``` r
processed_data <- rawdata %>% 
  filter(!is.na(mpg)) %>% 
  mutate(new_variable = mpg+1)
```

- Caching the processed_data chunk means that it will get re-run if the
  dplyr pipeline is changed, but it won’t get rerun if the
  **read_csv()** call changes. You can avoid that problem with the
  dependson chunk option:

’‘{r processed_data, cache = TRUE, dependson = “raw_data”}
processed_data \<- rawdata %\>% filter(!is.na(import_var)) %\>%
mutate(new_variable = complicated_transformation(x, y, z))’’

- dependson should contain a character vector of every chunk that the
  cached chunk depends on. Knitr will update the results for the cached
  chunk whenever it detects that one of its dependencies have changed.

- Note that the chunks won’t update if a_very_large_file.csv changes,
  because knitr caching only tracks changes within the .Rmd file. If you
  want to also track changes to that file you can use the
  **cache.extra** option. A good function to use is **file.info()**: it
  returns a bunch of information about the file including when it was
  last modified. Then you can write:
  `{r raw_data, cache.extra = file.info("a_very_large_file.csv")} rawdata <- readr::read_csv("a_very_large_file.csv")`

- As your caching strategies get progressively more complicated, it’s a
  good idea to regularly clear out all your caches with
  **knitr::clean_cache()**.

- global chung options: **knitr::opts_chunk\$set()**

3.  inline code

- To embed R code into an R Markdown document (tex) directly **`r`**
  (example diamond)

- To set number of digits

``` r
comma <- function(x) format(x, digits = 2, big.mark = ",")
comma(3452345.123) # why does it not produce 3,452,345.12
```

    ## [1] "3,452,345"

``` r
comma(.12358124331)
```

    ## [1] "0.12"

4.  YAML header

- ## Parameters

  output: html_document params: my_class: “suv” — ’’{r , include =
  FALSE} library(ggplot2) library(dplyr)

class \<- mpg %\>% filter(class == params\$my_class)’’
